/ # = javascript_include_tag "signup_show"
// CUSTOM HEADER
.row.header-nav
  .nav-links-wrapper.col-md-4.col-xs-5
    %a.no-padding.pull-left{href: "/storage_items"}
      %img#menu-img{:src => "https://s3.amazonaws.com/storage_rails_app_dev/images/qb-logo.png", :alt => ""}/
    %a.pull-left.no-side-padding{href: "/storage_items"}
      %span.light-gray.black-hover#menu-title QuickBox
  .nav-links-wrapper.col-md-1.col-md-offset-6.left-border.col-xs-2
    .no-border.nav-links
      = link_to "FAQ", faq_path, class:"light-gray black-hover", :target => "_blank"
  .nav-links-wrapper.col-md-1.col-xs-3
    .no-border.nav-links
      = link_to "Logout", destroy_user_session_path, method: "delete", class:"black-hover blue"

        




= render partial: "partials/just_blue_bar", locals:{mainText:" ", dashboard:true, faq:true}
.errors
  = render partial: "partials/error_messages_object_form", locals: {object: @user}
%br/ 
%br/ 
%br/ 

// Confirmation Page
%section.text-center
  .heading-about
    .container
      .row
        .col-lg-8.col-lg-offset-2
          .section-heading
            %h2.no-margin Account Confirmation
            %h3.light-gray (the last step)
  .container
    .row
      .col-lg-8.col-md-offset-2
        #pickup-details
          .row
            %h3.double-underlined Pickup Details
            .double-line
            = fields_for @user, html:{id:"delivery-form"} do |field|
              = render partial: "partials/delivery_addr_date", locals: {field:field, id:"datepicker"}

          %p.half-opacity
            No charges will take place until you put items in storage. 
            %br/ 
            To get a price estimate for your items click
            %span.blue.pointer 
              here.


        .row#payment-details.hidden
          %h3.double-underlined
            Payment Info
            / %p.pull-right.half-opacity
            / No charges will take place until you put items in storage
          .double-line
          
          // Credit Card Info Form
          = form_for @user, url:add_payment_signup_pages_path, html:{id:"credit-card-form"} do |cc|
            .bg-gray
              %br/
              = render partial: "partials/cc_info", locals:{field: cc}
              %br/ 
            
            %br/ 
            %div#finish-details.hidden
              %h3.double-underlined Finish Line

              .double-line
              .bg-gray
                %br/ 
                .row

                  .col-md-8.col-md-offset-2.align-left
                    .form-group
                      .row
                        .col-md-6.light-gray
                          = cc.label :promo_code, "Promo Code? (optional)", class:"no-margin"
                          = cc.text_field :promo_code, class:"form-control"
                        .col-md-6
                          = cc.label :referrer, "How did you hear about us?"
                          = cc.select  :referrer, options_for_select([["Divine Inspiration"], ["A Wise Man Told Me"], ["A Flyer"], ["A Friend"], ["Other"]]),{}, {class:"form-control"}
                      
              %br/
            #submit-details.hidden
              %p.align-left.light-gray.small-text * you will only be charged after pickup

              %br/
              %br/
              .row
                .col-md-5.col-md-offset-2.no-side-padding
                  %p.align-right.pull-right.pt-10
                    I agree to the
                    %a.pointer{"data-target" => "#myModal", "data-toggle" => "modal"} terms of service 
                .col-md-1
                  / # = cc.check_box :remember_me, class: "pull-left"
                  %input#terms-checkbox.pull-right{:type => "checkbox", required:true}/
                .col-md-4
                  .boxed-gray
                    = cc.submit 'confirm order', class:"btn btn-primary blue-bg-hover", id:"submit-button", disabled: true


%br/ 
%br/ 
= render :partial => "partials/footer"


/ Modal
#myModal.modal.fade{"aria-hidden" => "true", "aria-labelledby" => "myModalLabel", :role => "dialog", :tabindex => "-1"}
  .modal-dialog
    .modal-content
      .modal-header
        %button.close{"data-dismiss" => "modal", :type => "button"}
          %span{"aria-hidden" => "true"} Ã—
          %span.sr-only Close
        %h4#myModalLabel.modal-title Terms of Service
      .modal-body
        = render partial: "partials/terms_of_service_txt"
      .modal-footer
        %button.btn.btn-default.pull-left{"data-dismiss" => "modal", :type => "button"} Close

:javascript
  hideParentWhenZero("hide-when-zero");
  hideParentWhenNotUsed("hide-unused");
  

  sumItemList(".item-amount", "#subtotal", "/month");

 
   $(".form-control").on('input', function(e) { 

     $("#credit-card-form").data('bootstrapValidator').validate();
     $("#validator-id").data('bootstrapValidator').validate();
     
     if ($("#validator-id").data('bootstrapValidator').isValid()){
      $("#payment-details").removeClass("hidden");
      //$("#pickup-details").addClass("hidden");
      console.log("removing hidden");
     }

     if ($("#credit-card-form").data('bootstrapValidator').isValid()){
       $("#submit-button").removeAttr("disabled");
       $("#finish-details").removeClass("hidden");
       $("#submit-details").removeClass("hidden");

       console.log("submit button no longer disabled");
     } else {
        $("#submit-button").attr("disabled", true);
     }        
  
   });
  